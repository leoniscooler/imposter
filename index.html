<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Imposter Game</title>

 <style>
    * { 
      box-sizing: border-box; 
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #f4f4f8;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: #222;
      padding: 12px;
    }

    .container {
      width: 100%;
      max-width: 800px;
      min-width: 280px;
      padding: 16px 12px 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    h1 {
      text-align: center;
      margin: 0 0 8px;
      font-size: clamp(24px, 5vw, 32px);
      font-weight: 800;
      line-height: 1.2;
      padding: 0 8px;
      width: 100%;
    }

    p.instructions {
      margin: 0 0 20px;
      text-align: center;
      font-size: clamp(14px, 3.5vw, 16px);
      color: #555;
      line-height: 1.4;
      padding: 0 8px;
      max-width: 600px;
      width: 100%;
    }

    /* ===== Subject Selection ===== */
    .subject-section {
      width: 100%;
      max-width: 500px;
      margin-bottom: 20px;
      background: #fff;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .subject-section h2 {
      margin: 0 0 16px;
      text-align: center;
      font-size: clamp(18px, 4vw, 20px);
      color: #333;
      font-weight: 700;
    }

    .subject-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
      margin-bottom: 20px;
      width: 100%;
    }

    @media (max-width: 500px) {
      .subject-options {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }

    .subject-option {
      padding: 14px 10px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      background: #f9fafb;
      text-align: center;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      color: #4b5563;
      width: 100%;
    }

    .subject-option:hover {
      background: #f3f4f6;
      transform: translateY(-2px);
      border-color: #d1d5db;
    }

    .subject-option.selected {
      background: #e0e7ff;
      border-color: #4f46e5;
      color: #4f46e5;
      box-shadow: 0 4px 8px rgba(79, 70, 229, 0.1);
    }

    .custom-subject-container {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #e5e7eb;
      width: 100%;
    }

    .custom-subject-input {
      display: flex;
      gap: 10px;
      align-items: center;
      width: 100%;
    }

    @media (max-width: 480px) {
      .custom-subject-input {
        flex-direction: column;
      }
    }

    .custom-subject-input input {
      flex: 1;
      padding: 12px;
      font-size: 15px;
      border: 2px solid #ddd;
      border-radius: 10px;
      transition: border-color 0.2s;
      min-width: 0;
    }

    .custom-subject-input input:focus {
      outline: none;
      border-color: #4f46e5;
    }

    .custom-subject-btn {
      padding: 12px 20px;
      border: none;
      border-radius: 999px;
      background: linear-gradient(135deg, #10b981, #34d399);
      color: white;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
      transition: transform 0.12s ease, box-shadow 0.2s;
      box-shadow: 0 4px 8px rgba(16, 185, 129, 0.25);
    }

    @media (max-width: 480px) {
      .custom-subject-btn {
        width: 100%;
      }
    }

    .custom-subject-btn:hover {
      box-shadow: 0 6px 12px rgba(16, 185, 129, 0.3);
    }

    .custom-subject-btn:active {
      transform: scale(0.96);
    }

    .selected-subject-display {
      text-align: center;
      margin: 20px 0;
      padding: 16px;
      background: linear-gradient(135deg, #e0e7ff, #f3f4f6);
      border-radius: 14px;
      border: 2px solid #4f46e5;
      width: 100%;
    }

    .selected-subject-display h3 {
      margin: 0 0 8px;
      font-size: 16px;
      color: #6b7280;
      font-weight: 600;
    }

    .selected-subject-display .subject-name {
      font-size: clamp(20px, 4vw, 22px);
      font-weight: 800;
      color: #4f46e5;
      margin: 0;
      word-break: break-word;
    }

    .change-subject-btn {
      display: block;
      margin: 8px auto 0;
      padding: 8px 16px;
      border: none;
      border-radius: 999px;
      background: #f3f4f6;
      color: #6b7280;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      width: fit-content;
    }

    .change-subject-btn:hover {
      background: #e5e7eb;
      color: #4b5563;
    }

    /* ===== Controls ===== */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      background: #fff;
      padding: 16px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      width: 100%;
      max-width: 500px;
    }

    .controls > div {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-width: 120px;
      max-width: 200px;
    }

    @media (max-width: 480px) {
      .controls {
        flex-direction: column;
        align-items: stretch;
        gap: 16px;
      }
      
      .controls > div {
        max-width: 100%;
        min-width: 0;
      }
    }

    .controls label {
      font-size: 14px;
      color: #444;
      margin-bottom: 6px;
      font-weight: 600;
      text-align: center;
    }

    .controls input {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 10px;
      text-align: center;
      transition: border-color 0.2s;
    }

    .controls input:focus {
      outline: none;
      border-color: #4f46e5;
    }

    .btn {
      padding: 14px 24px;
      border: none;
      border-radius: 999px;
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: white;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      max-width: 300px;
      text-align: center;
      transition: transform 0.12s ease, box-shadow 0.2s;
      box-shadow: 0 4px 12px rgba(79, 70, 229, 0.25);
      margin-top: 8px;
    }

    .btn:hover {
      box-shadow: 0 6px 16px rgba(79, 70, 229, 0.3);
    }

    .btn:active {
      transform: scale(0.96);
    }

    .btn:disabled {
      background: linear-gradient(135deg, #9ca3af, #d1d5db);
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    .error {
      text-align: center;
      color: #dc2626;
      min-height: 20px;
      font-size: 14px;
      font-weight: 500;
      margin: 8px 0 16px;
      width: 100%;
      padding: 0 12px;
      max-width: 500px;
    }

    /* ===== Cards ===== */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 16px;
      width: 100%;
      max-width: 1000px;
      justify-items: center;
    }

    @media (max-width: 600px) {
      .cards {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 10px;
      }
    }

    @media (max-width: 400px) {
      .cards {
        grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
        gap: 8px;
      }
    }

    @media (max-width: 350px) {
      .cards {
        grid-template-columns: 1fr;
        max-width: 280px;
      }
    }

    .card {
      background: #fff;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 8px;
      user-select: none;
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
      width: 100%;
      max-width: 200px;
    }

    @media (max-width: 600px) {
      .card {
        max-width: 180px;
      }
    }

    @media (max-width: 400px) {
      .card {
        max-width: 160px;
        padding: 12px;
      }
    }

    @media (max-width: 350px) {
      .card {
        max-width: 100%;
      }
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: clamp(14px, 3vw, 16px);
      font-weight: 700;
    }

    .status-label {
      font-size: 11px;
      text-transform: uppercase;
      color: #777;
      font-weight: 600;
      letter-spacing: 0.5px;
      transition: color 0.15s;
    }

    /* ===== Word box ===== */
    .word-box {
      padding: 16px 10px;
      border-radius: 12px;
      border: 1px dashed #bbb;
      text-align: center;
      font-size: clamp(16px, 4vw, 20px);
      font-weight: 800;
      opacity: 0;
      transform: scale(0.9);
      transition: opacity 0.25s, transform 0.25s;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      word-break: break-word;
      overflow-wrap: break-word;
      width: 100%;
    }

    @media (max-width: 400px) {
      .word-box {
        min-height: 54px;
        padding: 12px 8px;
      }
    }

    .word-hidden { 
      color: #777; 
    }
    
    .word-revealed { 
      color: #111; 
      opacity: 1; 
      transform: scale(1); 
    }

    .word-locked {
      color: #999;
      font-style: italic;
      opacity: 1;
      transform: scale(1);
      font-size: 18px;
    }

    /* ===== Category box ===== */
    .category-box {
      padding: 10px 12px;
      border-radius: 10px;
      background: #eef2ff;
      text-align: center;
      font-size: clamp(14px, 3.5vw, 16px);
      font-weight: 600;
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.25s, transform 0.25s;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      word-break: break-word;
      width: 100%;
    }

    @media (max-width: 400px) {
      .category-box {
        min-height: 40px;
        padding: 8px 10px;
      }
    }

    .category-shown {
      opacity: 1;
      transform: translateY(0);
    }

    /* ===== Button ===== */
    .card-btn {
      padding: 12px 14px;
      border-radius: 999px;
      border: none;
      background: #e5e7eb;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      transition: all 0.2s;
      color: #333;
      margin-top: 4px;
    }

    .card-btn:active {
      transform: scale(0.96);
    }

    .card-btn.locked {
      background: #d1d5db;
      color: #6b7280;
      cursor: default;
      transform: none;
      opacity: 0.8;
    }

    /* ===== Status Section ===== */
    .status-section {
      margin-top: 28px;
      width: 100%;
      max-width: 500px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .reveal-tracker {
      text-align: center;
      margin-bottom: 20px;
      font-size: clamp(16px, 4vw, 20px);
      font-weight: 800;
      color: #4f46e5;
      min-height: 32px;
      padding: 16px;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 100%;
    }

    .first-player {
      text-align: center;
      padding: 20px 16px;
      background: linear-gradient(135deg, #4f46e5, #8b5cf6);
      color: white;
      border-radius: 18px;
      font-size: clamp(18px, 5vw, 24px);
      font-weight: 900;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s, transform 0.5s;
      box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
      width: 100%;
      line-height: 1.3;
    }

    .first-player.show {
      opacity: 1;
      transform: translateY(0);
    }

    .footer-note {
      margin-top: 24px;
      text-align: center;
      font-size: 13px;
      color: #666;
      padding: 0 12px;
      line-height: 1.5;
      max-width: 500px;
      width: 100%;
    }

    /* Small screen optimizations */
    @media (max-width: 480px) {
      body {
        padding: 8px;
        align-items: flex-start;
      }
      
      .container {
        padding: 12px 8px 20px;
      }
      
      .subject-section {
        padding: 16px;
      }
      
      .controls {
        padding: 14px;
        gap: 10px;
      }
      
      .subject-options {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }
    }

    /* Very small screen adjustments */
    @media (max-width: 350px) {
      .subject-options {
        grid-template-columns: 1fr;
      }
      
      .card-header {
        flex-direction: column;
        gap: 4px;
        align-items: flex-start;
      }
      
      .status-label {
        align-self: flex-end;
      }
    }

    /* Ensure everything stays within viewport */
    @media (max-height: 700px) and (orientation: portrait) {
      body {
        align-items: flex-start;
        padding-top: 4px;
      }
      
      .container {
        padding-top: 8px;
      }
      
      h1 {
        margin-bottom: 4px;
      }
      
      .instructions {
        margin-bottom: 12px;
      }
    }

    /* Landscape optimization */
    @media (max-height: 500px) and (orientation: landscape) {
      body {
        padding: 4px;
        align-items: flex-start;
      }
      
      .container {
        padding: 8px 6px 12px;
      }
      
      .cards {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 8px;
        margin-top: 12px;
      }
      
      .card {
        max-width: 160px;
        padding: 10px;
      }
      
      .word-box {
        min-height: 48px;
        padding: 10px 6px;
      }
      
      .category-box {
        min-height: 36px;
        padding: 6px 8px;
      }
    }
  </style>
</head>

<body>
<div class="container">

  <h1>Imposter Game</h1>
  <p class="instructions">
    You get a word + category. Imposters see the category, too.<br>
    Cards can only be opened once.
  </p>

  <div class="subject-section" id="subjectSection">
    <h2>Choose a Subject</h2>
    
    <div id="subjectDisplay" class="selected-subject-display" style="display: none;">
      <h3>Selected Subject:</h3>
      <div class="subject-name" id="selectedSubjectName"></div>
      <button class="change-subject-btn" id="changeSubjectBtn">Change Subject</button>
    </div>
    
    <div id="subjectSelection">
      <div class="subject-options" id="subjectOptions">
        <!-- Subjects will be added here by JavaScript -->
      </div>
      
      <div class="custom-subject-container">
        <div class="custom-subject-input">
          <input type="text" id="customSubjectInput" placeholder="Enter any word or phrase...">
          <button class="custom-subject-btn" id="customSubjectBtn">Use Custom</button>
        </div>
      </div>
    </div>
  </div>

  <div class="controls">
    <div>
      <label>Players</label>
      <input id="playerCount" type="number" min="3" max="20" value="3">
    </div>

    <div>
      <label>Imposters</label>
      <input id="imposterCount" type="number" min="1" max="10" value="1">
    </div>

    <button id="generateBtn" class="btn" disabled>Deal Cards</button>
  </div>

  <div id="error" class="error"></div>
  
  <div id="cardsContainer" class="cards"></div>
  
  <!-- Status section moved to bottom -->
  <div class="status-section">
    <div id="revealTracker" class="reveal-tracker"></div>
    <div id="firstPlayer" class="first-player"></div>
  </div>

  <div class="footer-note">
    Close your card before passing the device.
  </div>
  <div class="footer-note">
    leoniscool.com
  </div>

</div>

<script>
/* ====== GAME STATE ===== */
let currentSubject = "";
let actualCustomSubject = ""; // Stores the actual custom word
let customItems = [];
let totalCards = 0;
let revealedCards = 0;
let lockedCards = 0;
let playerNumbers = [];

/* ===== ELEMENTS ===== */
const cardsContainer = document.getElementById("cardsContainer");
const generateBtn = document.getElementById("generateBtn");
const playerCountInput = document.getElementById("playerCount");
const imposterCountInput = document.getElementById("imposterCount");
const errorBox = document.getElementById("error");
const revealTracker = document.getElementById("revealTracker");
const firstPlayerBox = document.getElementById("firstPlayer");
const subjectSection = document.getElementById("subjectSection");
const subjectOptions = document.getElementById("subjectOptions");
const subjectDisplay = document.getElementById("subjectDisplay");
const subjectSelection = document.getElementById("subjectSelection");
const selectedSubjectName = document.getElementById("selectedSubjectName");
const changeSubjectBtn = document.getElementById("changeSubjectBtn");
const customSubjectInput = document.getElementById("customSubjectInput");
const customSubjectBtn = document.getElementById("customSubjectBtn");

/* ===== DEFAULT SUBJECTS ===== */
const defaultSubjects = {
  "Clash Royale": {
    troops: ["Archers","Archer Queen","Baby Dragon","Balloon","Bandit","Barbarians","Bats","Battle Healer","Battle Ram",
      "Berserker","Bomber","Boss Bandit","Bowler","Bush Goblins","Cannon Cart","Cursed Hog","Dark Prince","Dart Goblin",
      "Electro Dragon","Electro Giant","Electro Spirit","Electro Wizard","Elite Barbarians","Elixir Blob","Elixir Golem",
      "Elixir Golemite","Executioner","Firecracker","Fire Spirit","Fisherman","Flying Machine","Furnace","Giant",
      "Giant Skeleton","Goblin Brawler","Goblin Gang","Goblin Demolisher","Goblin Giant","Goblin Machine","Goblins",
      "Goblinstein","Golden Knight","Golem","Golemite","Guardienne","Guards","Hog Rider","Hunter","Heal Spirit",
      "Ice Golem","Ice Spirit","Ice Wizard","Inferno Dragon","Knight","Lava Hound","Lava Pup","Little Prince","Lumberjack",
      "Magic Archer","Mega Knight","Mega Minion","Mighty Miner","Miner","Mini P.E.K.K.A.","Minion Horde","Minions",
      "Monk","Mother Witch","Monster","Musketeer","Night Witch","P.E.K.K.A.","Phoenix","Prince","Princess","Ram Rider",
      "Rascal Boy","Rascal Girl","Royal Ghost","Royal Giant","Royal Hogs","Royal Recruits","Rune Giant","Skeleton Army",
      "Skeleton Barrel","Skeleton Dragons","Skeleton King","Skeletons","Sparky","Spear Goblins","Spirit Empress",
      "Suspicious Bush","Three Musketeers","Valkyrie","Wall Breakers","Witch","Wizard","Zappies"
    ],
    
    buildings: ["Bomb Tower","Cannon","Inferno Tower","Mortar","Tesla","X-Bow","Barbarian Hut","Elixir Collector",
      "Goblin Cage","Goblin Drill","Goblin Hut","Tombstone"
    ],
    
    spells: ["Arrows","Barbarian Barrel","Earthquake","Fireball","Freeze","Giant Snowball","Goblin Curse","Lightning",
      "Poison","Rage","Rocket","Royal Delivery","The Log","Tornado","Vines","Void","Zap"
    ]
  },
  
  "Physics": {
    kinematics: [
      "Displacement","Velocity","Acceleration","Free Fall","Projectile Motion","Kinematic Equations","Constant Acceleration",
      "Position-Time Graph","Velocity-Time Graph"
    ],

    forces: [
      "Newton's First Law","Newton's Second Law","Newton's Third Law","Force","Mass","Weight","Friction","Normal Force",
      "Tension","Net Force","Inertia","Equilibrium","Free Body Diagram","Air Resistance", "F=ma"
    ],

    energy: [
      "Kinetic Energy","Potential Energy","Conservation of Energy","Work","Power","Mechanical Energy","Thermal Energy",
      "Energy Transfer","Work-Energy Theorem","Efficiency","Gravitational Energy","Spring Energy","Elastic Energy",
      "Hooke’s Law","Simple Machines","Energy Loss"
    ],

    momentum: [
      "Linear Momentum","Impulse","Conservation of Momentum","Elastic Collision","Inelastic Collision","Center of Mass",
      "Momentum Transfer","Recoil","Explosion","Momentum Vector","Elastic Bounce","Inelastic Bounce","Perfectly Inelastic",
      "Angular Momentum"
    ],

    circular: [
      "Centripetal Force","Centripetal Acceleration","mv^2/r", "v^2/r"
    ],

    fluids: [
      "Density","Pressure","Buoyancy","Archimedes' Principle","Bernoulli's Principle","Continuity Equation","Fluid Flow",
      "Laminar Flow","Viscosity","Hydraulic Lift","Pascal’s Law","Hydrostatic Pressure","Streamlines","Flow Rate","Turbulent Flow"
    ],

    rotation: [
      "Angular Acceleration","Angular Momentum","Inertia","Center of Mass", "Rotational Kinetic Energy", "Rotational Kinematics"
    ],

    shm: [
      "Periodic Motion","Frequency","Amplitude","Phase","Restoring Force","Spring Oscillation","Pendulum Oscillation","Resonance"
    ],

    thermo: [
      "Temperature","Heat Transfer","Conduction","Convection","Radiation","Internal Energy","Specific Heat",
      "Thermal Equilibrium"
    ],

    electricity: [
      "Charge","Electric Field","Voltage","Current","Resistance","Ohm’s Law","Power","Series Circuit",
      "Parallel Circuit","Circuit Diagram"
    ],

    gravity: [
      "Gravitational Constant","Gravitational Force","mg","Kepler's 3rd law"
    ]
  },
  
  "Math": {
    algebra: [
      "Variable","Expression","Equation","Inequality","Linear Equation",
      "Quadratic Equation","Polynomial","Factoring","Completing the Square",
      "Exponential Function","Logarithmic Function","Rational Expression",
      "System of Equations","Matrix","Vector","Function","Domain","Range"
    ],

    geometry: [
      "Point","Line","Plane","Angle","Congruent","Similarity","Triangle",
      "Pythagorean Theorem","Circle","Radius","Diameter","Chord","Arc",
      "Central Angle","Inscribed Angle","Area","Perimeter","Volume","Surface Area"
    ],

    trigonometry: [
      "Sine","Cosine","Tangent","Unit Circle","Radians","Degrees",
      "Pythagorean Identity","Law of Sines","Law of Cosines","Trigonometric Graphs",
      "Amplitude","Period","Phase Shift","Inverse Trig Function"
    ],

    precalculus: [
      "Sequence","Series","Arithmetic Sequence","Geometric Sequence",
      "Binomial Theorem","Polynomial Division","Rational Function",
      "Asymptote","Complex Number","Imaginary Unit"
    ],

    statistics: [
      "Mean","Median","Mode","Range","Standard Deviation","Variance",
      "Probability","Combination","Permutation","Normal Distribution",
      "Outlier","Correlation"
    ]
  },

  "Calculus": {
    limits: [
      "Limit","Continuity","One-Sided Limit","Infinite Limit","Limit Laws","Indeterminate Form",
      "Removable Discontinuity","Jump Discontinuity","Vertical Asymptote","Horizontal Asymptote",
      "Squeeze Theorem","L'Hôpital's Rule"
    ],

    derivatives: [
      "Derivative","Differentiability","Tangent Line","Instantaneous Rate","Power Rule","Sum Rule","Difference Rule",
      "Product Rule","Quotient Rule","Chain Rule","Implicit Differentiation","Higher Derivative","Second Derivative",
      "Third Derivative","Inverse Function","Logarithmic Differentiation","Exponential Derivative","Trig Derivative"
    ],

    applicationsOfDerivatives: [
      "Critical Point","Local Maximum","Local Minimum","First Derivative Test","Second Derivative Test",
      "Inflection Point","Concave Up","Concave Down","Optimization","Related Rates",
      "Velocity Function","Acceleration Function","Motion on a Line","Mean Value Theorem"
    ],

    integrals: [
      "Antiderivative","Indefinite Integral","Definite Integral","Constant of Integration","Net Change",
      "Area Under Curve","Riemann Sum","Trapezoidal Rule","Accumulation Function","Average Value",
      "U-Substitution"
    ],

    applicationsOfIntegrals: [
      "Differential Equation","Separation of Variables","Initial Condition","Rate of Change",
      "Motion with Acceleration","Distance and Displacement","Growth and Decay"
    ],

    theorems: [
      "Fundamental Theorem of Calculus","Mean Value Theorem","Rolle’s Theorem"
    ]
  },
  
  "Computer Science": {
    programmingBasics: [
      "Variable","Constant","Data Type","Integer","Float","Boolean","String",
      "Expression","Statement","Comment","Indentation"
    ],

    basicCommands: [
      "If Statement","Else Statement","Else If","Comparison Operator","Logical Operator",
      "For Loop","While Loop","Break","Continue","Iteration","Recursion"
    ],

    functions: [
      "Function","Parameter","Argument","Return Value","Scope","Local Variable",
      "Global Variable","Function Call","Function Definition"
    ],

    dataStructures: [
      "Array","List","Tuple","Dictionary","Object","Stack","Queue","Set",
      "Linked List","Tree","Binary Tree","Graph","Hash Table","Pointer","Node"
    ],

    algorithms: [
      "Searching","Linear Search","Binary Search","Sorting","Bubble Sort",
      "Selection Sort","Insertion Sort","Merge Sort","Quick Sort",
      "Time Complexity","Space Complexity","Big O Notation","Recursion","Divide and Conquer"
    ],

    ai: [
      "Machine Learning","Neural Network","Training","Testing","Dataset",
      "Supervised Learning","Unsupervised Learning","Classification",
      "Regression","Accuracy","Precision","Recall","Overfitting","Underfitting"
    ],
    
    languages: [
      "Python","Java","JavaScript","C","C++","C#","Scratch","SQL","HTML","CSS"
    ]
  },

  "Animals": {
    mammals: ["Lion","Elephant","Dolphin","Kangaroo","Panda","Giraffe","Tiger","Wolf","Bear","Monkey"],
    birds: ["Eagle","Penguin","Peacock","Owl","Hummingbird","Parrot","Flamingo","Swan","Woodpecker","Kingfisher"],
    reptiles: ["Crocodile","Komodo Dragon","Chameleon","Iguana","Gecko","Turtle","Snake","Alligator","Monitor Lizard","Tortoise"],
    aquatic: ["Shark","Octopus","Jellyfish","Starfish","Seahorse","Whale","Dolphin","Squid","Crab","Lobster"],
    insects: ["Butterfly","Dragonfly","Ladybug","Ant","Bee","Spider","Beetle","Grasshopper","Mantis","Firefly"]
  },
  
  "Fruits": {
    citrus: ["Orange","Lemon","Lime","Grapefruit","Tangerine","Clementine","Kumquat","Pomelo","Yuzu","Ugli Fruit"],
    tropical: ["Mango","Pineapple","Coconut","Papaya","Dragon Fruit","Passion Fruit","Guava","Lychee","Rambutan","Durian"],
    berries: ["Strawberry","Blueberry","Raspberry","Blackberry","Cranberry","Gooseberry","Elderberry","Boysenberry","Mulberry","Acai Berry"],
    stone: ["Peach","Plum","Cherry","Apricot","Nectarine","Mango","Lychee","Date","Olive","Coconut"],
    melons: ["Watermelon","Cantaloupe","Honeydew","Galia","Canary","Santa Claus","Crenshaw","Sharlyn","Casaba","Sprite"]
  },
  
  "Countries": {
    europe: ["France","Germany","Italy","Spain","United Kingdom","Greece","Netherlands","Sweden","Switzerland","Norway"],
    asia: ["Japan","China","India","South Korea","Thailand","Vietnam","Indonesia","Philippines","Malaysia","Singapore"],
    americas: ["United States","Canada","Brazil","Mexico","Argentina","Chile","Peru","Colombia","Cuba","Jamaica"],
    africa: ["Egypt","South Africa","Kenya","Morocco","Nigeria","Ghana","Tanzania","Ethiopia","Uganda","Rwanda"],
    oceania: ["Australia","New Zealand","Fiji","Papua New Guinea","Samoa","Tonga","Vanuatu","Solomon Islands","Kiribati","Micronesia"]
  },
  
  "Sports": {
    ball: ["Basketball","Soccer","Football","Baseball","Tennis","Volleyball","Golf","Rugby","Cricket","Handball"],
    water: ["Swimming","Surfing","Water Polo","Diving","Rowing","Sailing","Canoeing","Kayaking","Water Skiing","Synchronized Swimming"],
    winter: ["Skiing","Snowboarding","Ice Hockey","Figure Skating","Bobsleigh","Curling","Biathlon","Luge","Speed Skating","Freestyle Skiing"],
    combat: ["Boxing","Wrestling","Martial Arts","Fencing","Judo","Taekwondo","Karate","MMA","Kendo","Sumo"],
    individual: ["Gymnastics","Athletics","Cycling","Archery","Weightlifting","Triathlon","Equestrian","Shooting","Badminton","Table Tennis"]
  },
  
   "Names": {
    name: ["Leon","Matteo","Illay","Carver","Ethan","Naoki","Thomas","Sean","Luke", "Nico", "Claire"]
  },
  
  "Minecraft": {
  
  mobs: [
    "Villager","Cow","Pig","Chicken","Sheep","Wolf","Horse","Cat","Fox","Bee","Rabbit","Parrot","Llama",
    "Zombie","Skeleton","Creeper","Spider","Enderman","Slime","Witch","Phantom","Pillager","Blaze","Ghast",
    "Piglin","Hoglin","Guardian","Evoker","Vex","Warden","Ender Dragon","Wither"
  ],

  blocks: [
    "Stone","Dirt","Sand","Gravel","Wood","Leaves","Glass","Obsidian","Clay","Bricks","Netherrack","End Stone",
    "Basalt","Deepslate","Bedrock"
  ],

  resources: [
    "Coal","Iron","Gold","Diamond","Emerald","Redstone","Lapis","Copper","Nether Quartz","Ancient Debris"
  ],

  items: [
    "Sword","Axe","Pickaxe","Shovel","Bow","Shield","Trident","Fishing Rod","Compass","Clock","Shears","Map"
  ],

  food: [
    "Bread","Steak","Cooked Porkchop","Cooked Chicken","Baked Potato","Carrot","Apple","Melon","Chorus Fruit",
    "Golden Apple","Pumpkin Pie","Honey Bottle"
  ],

  structures: [
    "Village","Temple","Stronghold","Mineshaft","Ocean Monument","Ruined Portal","Nether Fortress","Bastion",
    "End City","Ancient City"
  ],

  biomes: [
    "Plains","Forest","Taiga","Jungle","Desert","Savanna","Swamp","Mountains","Snowy Biome","Ocean","Badlands",
    "Mushroom Biome","Nether","End"
  ],

  toolsAndGear: [
    "Pickaxe","Sword","Axe","Hoe","Shovel","Armor","Helmet","Chestplate","Leggings","Boots","Shield","Crossbow"
  ],

  magicAndPotions: [
    "Enchanting Table","Potion of Healing","Potion of Strength","Potion of Swiftness","Potion of Fire Resistance",
    "Potion of Regeneration","Potion of Invisibility","Potion of Slow Falling"
  ]
},

"Geometry Dash": {
  levels: [
    "Stereo Madness","Back on Track","Polargeist","Dry Out","Base After Base","Can't Let Go","Jumper",
    "Time Machine","Cycles","xStep","Clutterfunk","Theory of Everything","Electroman Adventures",
    "Geometrical Dominator","Hexagon Force","Blast Processing","Electrodynamix","Clubstep","Theory of Everything 2",
    "Deadlocked","ORBIT","LIMBO","Bloodbath","Top 10","Bloodshower","Purpular Rectanglisi (mer green)","Sonic Wave",
    "Change of Scene","Absolute Garbage","HOW","WHAT","Grass","Nagatabi","Sunrise","Night City"
  ],

  gamemodes: [
    "Cube","Robot","Ship","Ball","Wave","Spider","UFO","Swing Copter"
  ],

  structures: [
    "Ekirby8 Tower","Clubstep Monster","Triple Spike"
  ]
},

"Objects": {
  objects: [
    "Chair","Table","Sofa","Bed","Lamp","Mirror","Clock","Pillow","Blanket",
    "Curtain","Candle","TV","Remote","Shelf","Plate","Cup","Fork","Knife",
    "Spoon","Pan","Pot","Bottle","Microwave","Fridge","Toaster","Phone",
    "Laptop","Tablet","Headphones","Charger","Mouse","Keyboard","Camera",
    "Smartwatch","Speaker","Notebook","Pencil","Pen","Eraser","Ruler",
    "Backpack","Calculator","Binder","Shirt","Pants","Jacket","Hat","Socks",
    "Shoes","Gloves","Belt","Hammer","Screwdriver","Wrench","Pliers","Drill",
    "Saw","Tape Measure","Car","Bike","Bus","Train","Scooter","Motorcycle",
    "Airplane","Boat","Wallet","Keys","Water Bottle","Backpack","Trash Can",
    "Umbrella","Broom","Mop","Vacuum","Toothbrush","Toothpaste","Soap",
    "Shampoo","Comb","Hairdryer","Sunglasses","Watch","Notebook","Stapler",
    "Paperclip","Highlighter","Glue","Scissors"
  ]
},

"Environmental Science": {

  ecology: [
    "Ecosystem","Biome","Habitat","Niche","Biodiversity","Species Richness","Species Evenness","Keystone Species",
    "Indicator Species","Invasive Species","Native Species","Endangered Species","Extinction","Speciation",
    
    "Population Growth","Carrying Capacity","Limiting Factor","Density-Dependent Factor","Density-Independent Factor",
    "r-Selected Species","K-Selected Species","Survivorship Curve","Population Dynamics","Growth Rate","Logistic Growth",
    
    "Producer","Consumer","Herbivore","Carnivore","Omnivore","Detritivore","Decomposer","Trophic Level","Food Web",
    "Primary Productivity","Gross Primary Productivity","Net Primary Productivity"
  ],

  cycles: [
    "Biogeochemical Cycle","Water Cycle","Carbon Cycle","Nitrogen Cycle","Phosphorus Cycle","Sulfur Cycle",
    "Evaporation","Condensation","Precipitation","Transpiration","Nitrogen Fixation","Assimilation","Respiration"
  ],

  atmosphereClimate: [
    "Climate","Weather","Albedo","Greenhouse Effect","Global Warming","Climate Change","Deforestation",
    "Desertification","Ocean Acidification","Glacier Retreat","Sea Level Rise","Carbon Sequestration",
    
    "Atmosphere","Troposphere","Stratosphere","Ozone Layer","Greenhouse Gas","CO2","Methane","Nitrous Oxide"
  ],

  earthSystems: [
    "Soil","Soil Formation","Soil Horizon","Erosion","Deposition","Humus","Sand","Silt","Clay","Soil Texture",
    
    "Plate Tectonics","Convergent Boundary","Divergent Boundary","Transform Boundary","Earthquake","Volcano","Subduction",
    
    "Tragedy of the Commons","Maximum Sustainable Yield","Resource Management","Sustainability","Ecological Footprint",
    "Conservation","Preservation","Restoration","Recycling","Composting"
  ],

  humanImpact: [
    "Air Pollution","Water Pollution","Noise Pollution","Light Pollution","Smog","Acid Rain","Eutrophication",
    "Biomagnification","Bioaccumulation","Turbidity","pH","Dissolved Oxygen",
    
    "Agriculture","Industrial Agriculture","Monoculture","Crop Rotation","Irrigation","Soil Degradation",
    "Pesticide","Fertilizer","Herbicide","Pesticide Resistance","Integrated Pest Management",
    
    "Mining","Overfishing","Bycatch","Habitat Fragmentation","Edge Effect","Urban Sprawl",
    
    "Fossil Fuel","Renewable Energy"
  ]
},

"Brawl Stars": {

  brawlers: [
    "Shelly","Colt","Brock","Jessie","Nita","Bull","Dynamike","Bo","El Primo","Barley",
    "Poco","Rico","Darryl","Penny","Pam","Frank","Mortis","Tara","Gene","Spike",
    "Crow","Leon","Sandy","Max","Mr. P","Sprout","Surge","Colette","Lou","Colonel Ruffs",
    "Belle","Buzz","Griff","Ash","Meg","Fang","Grom","Bonnie","Otis","Sam","Buster",
    "Chester","Mandy","R-T","Maisie","Hank","Cordelius","Larry & Lawrie","Draco","Spike Libre"
  ],
},

"AP Classes": {
  class: [
    "AP Calculus AB",
    "AP Calculus BC",
    "AP Statistics",
    "AP Computer Science A",
    "AP Computer Science Principles",
    "AP Biology",
    "AP Chemistry",
    "AP Physics 1",
    "AP Physics 2",
    "AP Physics C Mechanics",
    "AP Physics C Electricity & Magnetism",
    "AP Environmental Science",
    "AP Human Geography",
    "AP Psychology",
    "AP World History",
    "AP U.S. History",
    "AP European History",
    "AP Government & Politics",
    "AP Macroeconomics",
    "AP Microeconomics",
    "AP Spanish",
    "AP French",
    "AP Chinese",
    "AP Latin",
    "AP English Language",
    "AP English Literature",
    "AP Art History",
    "AP Music Theory",
    "AP Studio Art"
  ],
}

};

/* ===== LOCAL STORAGE LOAD ===== */
playerCountInput.value = localStorage.getItem("playerCount") || 3;
imposterCountInput.value = localStorage.getItem("imposterCount") || 1;
currentSubject = localStorage.getItem("currentSubject") || "";
actualCustomSubject = localStorage.getItem("actualCustomSubject") || "";
customItems = JSON.parse(localStorage.getItem("customItems")) || [];

/* ===== INITIALIZE SUBJECT OPTIONS ===== */
function initializeSubjectOptions() {
  subjectOptions.innerHTML = "";
  
  // Get all subject names and sort them alphabetically
  const sortedSubjectNames = Object.keys(defaultSubjects).sort();
  
  sortedSubjectNames.forEach(subject => {
    const option = document.createElement("div");
    option.className = "subject-option";
    option.textContent = subject;
    option.dataset.subject = subject;
    
    if (subject === currentSubject) {
      option.classList.add("selected");
    }
    
    option.addEventListener("click", () => selectSubject(subject));
    subjectOptions.appendChild(option);
  });
}

/* ===== SUBJECT MANAGEMENT ===== */
function selectSubject(subject) {
  // Remove selected class from all options
  document.querySelectorAll('.subject-option').forEach(opt => {
    opt.classList.remove('selected');
  });
  
  // Add selected class to clicked option
  const selectedOption = document.querySelector(`[data-subject="${subject}"]`);
  if (selectedOption) {
    selectedOption.classList.add('selected');
  }
  
  currentSubject = subject;
  actualCustomSubject = ""; // Clear custom subject when selecting a default one
  
  // For default subjects, combine all items from all categories
  customItems = [];
  Object.values(defaultSubjects[subject]).forEach(categoryItems => {
    customItems.push(...categoryItems);
  });
  
  localStorage.setItem("currentSubject", currentSubject);
  localStorage.setItem("actualCustomSubject", actualCustomSubject);
  localStorage.setItem("customItems", JSON.stringify(customItems));
  
  showSelectedSubject();
  enableGenerateButton();
  errorBox.textContent = "";
  
  // Clear custom input
  customSubjectInput.value = "";
}

function useCustomSubject() {
  const subject = customSubjectInput.value.trim();
  if (!subject) {
    errorBox.textContent = "Please enter a custom subject";
    return;
  }
  
  // Remove selected class from all options
  document.querySelectorAll('.subject-option').forEach(opt => {
    opt.classList.remove('selected');
  });
  
  // Store the actual custom word privately
  actualCustomSubject = subject;
  // Display "Custom" to users so they can't see what was entered
  currentSubject = "Custom";
  
  // Use only the exact word/phrase entered - no modifications
  customItems = [actualCustomSubject];
  
  localStorage.setItem("currentSubject", currentSubject);
  localStorage.setItem("actualCustomSubject", actualCustomSubject);
  localStorage.setItem("customItems", JSON.stringify(customItems));
  
  showSelectedSubject();
  enableGenerateButton();
  errorBox.textContent = "";
  
  // Clear input
  customSubjectInput.value = "";
}

function showSelectedSubject() {
  selectedSubjectName.textContent = currentSubject;
  subjectDisplay.style.display = 'block';
  subjectSelection.style.display = 'none';
}

function changeSubject() {
  subjectDisplay.style.display = 'none';
  subjectSelection.style.display = 'block';
  generateBtn.disabled = true;
  generateBtn.textContent = "Select Subject First";
  
  // Clear any existing cards
  cardsContainer.innerHTML = "";
  revealTracker.textContent = "";
  firstPlayerBox.classList.remove('show');
  firstPlayerBox.textContent = '';
}

function enableGenerateButton() {
  generateBtn.disabled = false;
  generateBtn.textContent = "Deal Cards";
}

/* ===== UPDATE TRACKER ===== */
function updateTracker() {
  if (totalCards === 0) {
    revealTracker.textContent = "";
    return;
  }
  
  revealTracker.textContent = `Revealed: ${revealedCards} / ${totalCards} cards`;
  
  if (lockedCards === totalCards && totalCards > 0) {
    selectFirstPlayer();
  }
}

/* ===== SELECT FIRST PLAYER ===== */
function selectFirstPlayer() {
  const randomPlayer = Math.floor(Math.random() * totalCards) + 1;
  
  setTimeout(() => {
    firstPlayerBox.textContent = `Player ${randomPlayer} goes first!`;
    firstPlayerBox.classList.add('show');
    firstPlayerBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, 500);
}

/* ===== HELPER FUNCTIONS ===== */
function getRandomItemFromArray(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

/* ===== MAIN GAME FUNCTION ===== */
function generateCards() {
  if (!currentSubject || customItems.length === 0) {
    errorBox.textContent = "Please select a subject first";
    return;
  }
  
  // Reset state
  revealedCards = 0;
  lockedCards = 0;
  playerNumbers = [];
  firstPlayerBox.classList.remove('show');
  firstPlayerBox.textContent = '';
  errorBox.textContent = "";

  const playerCount = parseInt(playerCountInput.value, 10);
  const imposterCount = parseInt(imposterCountInput.value, 10);

  if (playerCount < 3) {
    errorBox.textContent = "There must be at least 3 players.";
    return;
  }

  if (imposterCount < 1) {
    errorBox.textContent = "At least 1 imposter.";
    return;
  }

  if (imposterCount >= playerCount) {
    errorBox.textContent = "Imposters must be less than total players.";
    return;
  }

  // Save settings
  localStorage.setItem("playerCount", playerCount);
  localStorage.setItem("imposterCount", imposterCount);

  // Select random item from all available items
  const secretItem = getRandomItemFromArray(customItems);
  
  // Determine category based on whether it's a default subject
  let secretCategory = "Common";
  if (defaultSubjects[currentSubject]) {
    // Find which category the item belongs to
    for (const [category, items] of Object.entries(defaultSubjects[currentSubject])) {
      if (items.includes(secretItem)) {
        secretCategory = category;
        break;
      }
    }
  } else {
    // For custom subjects, just use "Custom" as the category
    secretCategory = "Custom";
  }

  let words = Array(playerCount).fill(secretItem);

  // Assign imposters
  while (words.filter(w => w === "Imposter").length < imposterCount) {
    const idx = Math.floor(Math.random() * playerCount);
    words[idx] = "Imposter";
  }

  // Shuffle
  for (let i = words.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [words[i], words[j]] = [words[j], words[i]];
  }

  cardsContainer.innerHTML = "";
  totalCards = playerCount;
  updateTracker();

  // Build cards
  words.forEach((word, i) => {
    const playerNumber = i + 1;
    playerNumbers.push(playerNumber);

    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="card-header">
        <span>Player ${playerNumber}</span>
        <span class="status-label">Hidden</span>
      </div>

      <div class="word-box word-hidden"></div>
      <div class="category-box"></div>

      <button class="card-btn">Reveal</button>
    `;

    const wordBox = card.querySelector(".word-box");
    const categoryBox = card.querySelector(".category-box");
    const btn = card.querySelector(".card-btn");
    const statusLabel = card.querySelector(".status-label");

    let viewed = false;
    let revealed = false;

    btn.addEventListener("click", () => {
      if (viewed) return;

      // Reveal
      if (btn.textContent === "Reveal") {
        wordBox.textContent = word === "Imposter" ? "Imposter" : word;
        wordBox.classList.add("word-revealed");

        categoryBox.textContent = "Category: " + secretCategory;
        categoryBox.classList.add("category-shown");

        btn.textContent = "Close";
        statusLabel.textContent = "Revealed";
        
        // Track reveal
        if (!revealed) {
          revealed = true;
          revealedCards++;
          updateTracker();
        }
        return;
      }

      // Close + lock
      if (btn.textContent === "Close") {
        viewed = true;

        wordBox.classList.remove("word-revealed");
        categoryBox.classList.remove("category-shown");

        setTimeout(() => {
          wordBox.textContent = "Locked";
          wordBox.className = "word-box word-locked";

          btn.textContent = "Locked";
          btn.classList.add("locked");
          btn.disabled = true;
          statusLabel.textContent = "Locked";
          
          // Track lock
          lockedCards++;
          updateTracker();
        }, 250);
      }
    });

    cardsContainer.appendChild(card);
  });
}

/* ===== EVENT LISTENERS ===== */
customSubjectBtn.addEventListener("click", useCustomSubject);
customSubjectInput.addEventListener("keypress", (e) => {
  if (e.key === "Enter") {
    useCustomSubject();
  }
});

changeSubjectBtn.addEventListener("click", changeSubject);
generateBtn.addEventListener("click", generateCards);

/* ===== INITIALIZATION ===== */
initializeSubjectOptions();

if (currentSubject) {
  showSelectedSubject();
  enableGenerateButton();
} else {
  generateBtn.disabled = true;
  generateBtn.textContent = "Select Subject First";
}
</script>
</body>
</html>

